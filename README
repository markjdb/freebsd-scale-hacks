This branch contains lots of dubious hacks.
